# n8n + OpenWeatherMap

é€™æ˜¯ä¸€å€‹åŸºæ–¼ **n8n** å¹³å°é–‹ç™¼çš„è‡ªå‹•åŒ–å·¥ä½œæµï¼Œèƒ½è‡ªå‹•æŠ“å– OpenWeatherMap çš„å°åŒ—å¸‚äº”å¤©é å ±è³‡æ–™ï¼Œä¸¦å°‡å…¶æ ¼å¼åŒ–å¾Œç²¾æº–å¯«å…¥ Google Sheets è©¦ç®—è¡¨ä¸­ã€‚

## ðŸš€ åŠŸèƒ½ç‰¹é»ž

* **å³æ™‚é å ±æŠ“å–**ï¼šç²å–å°åŒ—å¸‚ (taipei,tw) æœªä¾† 5 å¤©å…§æ¯ 3 å°æ™‚ä¸€æ¬¡çš„è©³ç´°å¤©æ°£æ•¸æ“šã€‚
* **ç¹é«”ä¸­æ–‡å„ªåŒ–**ï¼šOpenWeatherMap ç¯€é»žå·²è¨­å®š `language: zh_tw`ï¼Œç¢ºä¿å¤©æ°£æè¿°ï¼ˆå¦‚ï¼šæ™´ï¼Œå°‘é›²ï¼‰ä»¥ç¹é«”ä¸­æ–‡è¼¸å‡ºã€‚
* **é«˜æ•ˆæ•¸æ“šè™•ç†**ï¼šåˆ©ç”¨ `Split Out` ç¯€é»žè™•ç† API å›žå‚³çš„ 40 ç­†é å ±è³‡æ–™ï¼ˆ5å¤© x 8å€‹æ™‚æ®µï¼‰ï¼Œç¢ºä¿èƒ½é€è¡Œç©©å®šå¯«å…¥è©¦ç®—è¡¨ã€‚
* **è‡ªå‹•åŒ–å¯«å…¥**ï¼šå°‡æ™‚é–“ã€æ”æ°æ°£æº«èˆ‡æ°£å€™æè¿°è‡ªå‹•å°æ‡‰è‡³ Google Sheetsã€‚

## ðŸ—ï¸ å·¥ä½œæµæž¶æ§‹

æœ¬å·¥ä½œæµæŽ¡ç·šæ€§è¨­è¨ˆï¼Œçµæ§‹ç°¡å–®ä¸”æ˜“æ–¼ç¶­è­·ï¼š
1. **Manual Trigger**: æ‰‹å‹•è§¸ç™¼å•Ÿå‹•æµç¨‹ã€‚
2. **OpenWeatherMap**: ä¸²æŽ¥ API ç²å–å°åŒ—å¸‚å¤©æ°£é å ±ã€‚
3. **Split Out**: å°‡ `list` é™£åˆ—æ‹†åˆ†ç‚º 40 ç­†ç¨ç«‹è³‡æ–™é …ç›®ã€‚
4. **Append row in sheet**: å°‡æ¯ç­†é å ±è³‡æ–™å¯«å…¥ Google Sheetsã€‚

## ðŸ› ï¸ å®‰è£èˆ‡è¨­å®š

### 1. æº–å‚™å¤–éƒ¨æ†‘è­‰
* **OpenWeatherMap API Key**: è«‹è‡³ [OpenWeatherMap](https://openweathermap.org/) ç”³è«‹ API é‡‘é‘°ã€‚
* **Google Sheets OAuth2**: æŽˆæ¬Š n8n å­˜å–ä¸¦å¯«å…¥æ‚¨çš„ Google è©¦ç®—è¡¨ã€‚

### 2. é…ç½®æ‚¨çš„ Google è©¦ç®—è¡¨
ç‚ºäº†é¿å…åŸ·è¡ŒéŒ¯èª¤ï¼Œè«‹å‹™å¿…æŒ‰ç…§ä»¥ä¸‹è¦ç¯„è¨­å®šï¼š
1. åœ¨ Google Drive å»ºç«‹è©¦ç®—è¡¨ï¼Œä¸¦å°‡**åˆ†é åç¨±**ä¿ç•™ç‚ºé è¨­çš„ã€Œ**å·¥ä½œè¡¨1**ã€ï¼ˆæˆ–ç¢ºä¿ JSON ä¸­çš„ `sheetName` èˆ‡æ‚¨çš„åˆ†é åä¸€è‡´ï¼‰ã€‚
2. ç¬¬ä¸€è¡Œï¼ˆHeaderï¼‰å¿…é ˆæ‰‹å‹•å»ºç«‹ä»¥ä¸‹æ¨™é¡Œï¼š`æ™‚é–“`ã€`æ°£æº«`ã€`å¤©æ°£æ°£å€™`ã€‚
3. å¾ž URL ä¸­è¤‡è£½ **Spreadsheet ID**ï¼ˆä½æ–¼ `/d/` èˆ‡ `/edit` ä¹‹é–“ï¼‰ã€‚

### 3. åŒ¯å…¥èˆ‡èª¿æ•´ n8n å·¥ä½œæµ
1. ä¸‹è¼‰ä¸¦åŒ¯å…¥æœ¬å°ˆæ¡ˆæä¾›çš„ `open weather.json`ã€‚
2. æ‰“é–‹ **Append row in sheet** ç¯€é»žï¼Œå°‡ **Document** æ¬„ä½åˆ‡æ›ç‚º **ID** æ¨¡å¼ï¼Œä¸¦è²¼ä¸Šæ‚¨çš„ **Spreadsheet ID**ã€‚
3. æª¢æŸ¥ **OpenWeatherMap** ç¯€é»žä¸­çš„ API é‡‘é‘°æ˜¯å¦å·²æ­£ç¢ºé€£çµã€‚

## ðŸŽ¨ å·¥ä½œæµé‚è¼¯åœ– (Flowchart)

```mermaid
graph LR
    A[Manual Trigger] --> B[OpenWeatherMap]
    B --> C[Split Out]
    C --> D[Google Sheets]
    
    style B fill:#f96,stroke:#333
    style D fill:#3cba54,stroke:#333
